[2025-04-29T17:10:14.489+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-04-29T17:10:14.495+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: retrain_on_drift.train_log_mlflow manual__2025-04-29T17:09:37.899896+00:00 [queued]>
[2025-04-29T17:10:14.498+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: retrain_on_drift.train_log_mlflow manual__2025-04-29T17:09:37.899896+00:00 [queued]>
[2025-04-29T17:10:14.498+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 1
[2025-04-29T17:10:14.506+0000] {taskinstance.py:2889} INFO - Executing <Task(BashOperator): train_log_mlflow> on 2025-04-29 17:09:37.899896+00:00
[2025-04-29T17:10:14.516+0000] {standard_task_runner.py:72} INFO - Started process 171 to run task
[2025-04-29T17:10:14.519+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'retrain_on_drift', 'train_log_mlflow', 'manual__2025-04-29T17:09:37.899896+00:00', '--job-id', '224', '--raw', '--subdir', 'DAGS_FOLDER/drift_retrain_dag.py', '--cfg-path', '/tmp/tmp4a66z93y']
[2025-04-29T17:10:14.521+0000] {standard_task_runner.py:105} INFO - Job 224: Subtask train_log_mlflow
[2025-04-29T17:10:14.548+0000] {task_command.py:467} INFO - Running <TaskInstance: retrain_on_drift.train_log_mlflow manual__2025-04-29T17:09:37.899896+00:00 [running]> on host fca622891bf8
[2025-04-29T17:10:14.596+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='retrain_on_drift' AIRFLOW_CTX_TASK_ID='train_log_mlflow' AIRFLOW_CTX_EXECUTION_DATE='2025-04-29T17:09:37.899896+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-04-29T17:09:37.899896+00:00'
[2025-04-29T17:10:14.597+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2025-04-29T17:10:14.597+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2025-04-29T17:10:14.597+0000] {logging_mixin.py:190} INFO - Current task name:train_log_mlflow state:running start_date:2025-04-29 17:10:14.496051+00:00
[2025-04-29T17:10:14.597+0000] {logging_mixin.py:190} INFO - Dag name:retrain_on_drift and current dag run status:running
[2025-04-29T17:10:14.597+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-04-29T17:10:14.598+0000] {subprocess.py:78} INFO - Tmp dir root location: /tmp
[2025-04-29T17:10:14.599+0000] {subprocess.py:88} INFO - Running command: ['/usr/bin/bash', '-c', 'python /opt/mlflow/train.py /opt/***/data/processed/train.parquet v2']
[2025-04-29T17:10:14.610+0000] {subprocess.py:99} INFO - Output:
[2025-04-29T17:10:16.796+0000] {subprocess.py:106} INFO - 2025/04/29 17:10:16 INFO mlflow.tracking.fluent: Experiment with name 'Fraud detection model training' does not exist. Creating a new experiment.
[2025-04-29T17:10:16.817+0000] {subprocess.py:106} INFO - 2025/04/29 17:10:16 WARNING mlflow.utils.autologging_utils: You are using an unsupported version of lightgbm. If you encounter errors during autologging, try upgrading / downgrading lightgbm to a supported version, or try upgrading MLflow.
[2025-04-29T17:10:17.937+0000] {subprocess.py:106} INFO - 2025/04/29 17:10:17 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/***/.local/lib/python3.11/site-packages/mlflow/data/digest_utils.py:29: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead."
[2025-04-29T17:10:21.787+0000] {subprocess.py:106} INFO - 2025/04/29 17:10:21 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/***/.local/lib/python3.11/site-packages/mlflow/types/utils.py:393: UserWarning: Hint: Inferred schema contains integer column(s). Integer columns in Python cannot represent missing values. If your input data contains missing values at inference time, it will be encoded as floats and will cause a schema enforcement error. The best way to avoid this problem is to infer the model schema based on a realistic data sample (training dataset) that includes missing values. Alternatively, you can declare integer columns as doubles (float64) whenever these columns may have missing values. See `Handling Integers With Missing Values <https://www.mlflow.org/docs/latest/models.html#handling-integers-with-missing-values>`_ for more details."
[2025-04-29T17:10:21.798+0000] {subprocess.py:106} INFO - 2025/04/29 17:10:21 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/***/.local/lib/python3.11/site-packages/mlflow/data/digest_utils.py:29: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead."
[2025-04-29T17:10:22.488+0000] {subprocess.py:106} INFO - 2025/04/29 17:10:22 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/***/.local/lib/python3.11/site-packages/mlflow/types/utils.py:393: UserWarning: Hint: Inferred schema contains integer column(s). Integer columns in Python cannot represent missing values. If your input data contains missing values at inference time, it will be encoded as floats and will cause a schema enforcement error. The best way to avoid this problem is to infer the model schema based on a realistic data sample (training dataset) that includes missing values. Alternatively, you can declare integer columns as doubles (float64) whenever these columns may have missing values. See `Handling Integers With Missing Values <https://www.mlflow.org/docs/latest/models.html#handling-integers-with-missing-values>`_ for more details."
[2025-04-29T17:10:28.066+0000] {subprocess.py:106} INFO - 2025/04/29 17:10:28 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/***/.local/lib/python3.11/site-packages/mlflow/data/digest_utils.py:29: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead."
[2025-04-29T17:10:28.933+0000] {subprocess.py:106} INFO - 2025/04/29 17:10:28 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/***/.local/lib/python3.11/site-packages/mlflow/types/utils.py:393: UserWarning: Hint: Inferred schema contains integer column(s). Integer columns in Python cannot represent missing values. If your input data contains missing values at inference time, it will be encoded as floats and will cause a schema enforcement error. The best way to avoid this problem is to infer the model schema based on a realistic data sample (training dataset) that includes missing values. Alternatively, you can declare integer columns as doubles (float64) whenever these columns may have missing values. See `Handling Integers With Missing Values <https://www.mlflow.org/docs/latest/models.html#handling-integers-with-missing-values>`_ for more details."
[2025-04-29T17:10:32.624+0000] {subprocess.py:106} INFO - /home/***/.local/lib/python3.11/site-packages/scipy/stats/_stats_py.py:7335: RuntimeWarning: divide by zero encountered in divide
[2025-04-29T17:10:32.634+0000] {subprocess.py:106} INFO -   terms = (f_obs - f_exp)**2 / f_exp
[2025-04-29T17:10:32.663+0000] {subprocess.py:106} INFO - /home/***/.local/lib/python3.11/site-packages/scipy/stats/_stats_py.py:7335: RuntimeWarning: divide by zero encountered in divide
[2025-04-29T17:10:32.667+0000] {subprocess.py:106} INFO -   terms = (f_obs - f_exp)**2 / f_exp
[2025-04-29T17:10:32.710+0000] {subprocess.py:106} INFO - /home/***/.local/lib/python3.11/site-packages/scipy/stats/_stats_py.py:7335: RuntimeWarning: divide by zero encountered in divide
[2025-04-29T17:10:32.713+0000] {subprocess.py:106} INFO -   terms = (f_obs - f_exp)**2 / f_exp
[2025-04-29T17:10:32.726+0000] {subprocess.py:106} INFO - /home/***/.local/lib/python3.11/site-packages/scipy/stats/_stats_py.py:7335: RuntimeWarning: divide by zero encountered in divide
[2025-04-29T17:10:32.729+0000] {subprocess.py:106} INFO -   terms = (f_obs - f_exp)**2 / f_exp
[2025-04-29T17:10:32.744+0000] {subprocess.py:106} INFO - /home/***/.local/lib/python3.11/site-packages/scipy/stats/_stats_py.py:7335: RuntimeWarning: divide by zero encountered in divide
[2025-04-29T17:10:32.744+0000] {subprocess.py:106} INFO -   terms = (f_obs - f_exp)**2 / f_exp
[2025-04-29T17:10:32.765+0000] {subprocess.py:106} INFO - /home/***/.local/lib/python3.11/site-packages/scipy/stats/_stats_py.py:7335: RuntimeWarning: divide by zero encountered in divide
[2025-04-29T17:10:32.765+0000] {subprocess.py:106} INFO -   terms = (f_obs - f_exp)**2 / f_exp
[2025-04-29T17:10:32.821+0000] {subprocess.py:106} INFO - /home/***/.local/lib/python3.11/site-packages/scipy/stats/_stats_py.py:7335: RuntimeWarning: divide by zero encountered in divide
[2025-04-29T17:10:32.823+0000] {subprocess.py:106} INFO -   terms = (f_obs - f_exp)**2 / f_exp
[2025-04-29T17:10:32.917+0000] {subprocess.py:106} INFO - /home/***/.local/lib/python3.11/site-packages/scipy/stats/_stats_py.py:7335: RuntimeWarning: divide by zero encountered in divide
[2025-04-29T17:10:32.918+0000] {subprocess.py:106} INFO -   terms = (f_obs - f_exp)**2 / f_exp
[2025-04-29T17:10:33.185+0000] {subprocess.py:106} INFO - /home/***/.local/lib/python3.11/site-packages/scipy/stats/_stats_py.py:7335: RuntimeWarning: divide by zero encountered in divide
[2025-04-29T17:10:33.186+0000] {subprocess.py:106} INFO -   terms = (f_obs - f_exp)**2 / f_exp
[2025-04-29T17:10:33.655+0000] {subprocess.py:106} INFO - 2025/04/29 17:10:33 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/***/.local/lib/python3.11/site-packages/mlflow/data/digest_utils.py:29: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead."
[2025-04-29T17:10:34.295+0000] {subprocess.py:106} INFO - 2025/04/29 17:10:34 WARNING mlflow.utils.autologging_utils: MLflow autologging encountered a warning: "/home/***/.local/lib/python3.11/site-packages/mlflow/types/utils.py:393: UserWarning: Hint: Inferred schema contains integer column(s). Integer columns in Python cannot represent missing values. If your input data contains missing values at inference time, it will be encoded as floats and will cause a schema enforcement error. The best way to avoid this problem is to infer the model schema based on a realistic data sample (training dataset) that includes missing values. Alternatively, you can declare integer columns as doubles (float64) whenever these columns may have missing values. See `Handling Integers With Missing Values <https://www.mlflow.org/docs/latest/models.html#handling-integers-with-missing-values>`_ for more details."
[2025-04-29T17:10:35.459+0000] {subprocess.py:106} INFO - 2025/04/29 17:10:35 WARNING mlflow.utils.requirements_utils: Detected one or more mismatches between the model's dependencies and the current Python environment:
[2025-04-29T17:10:35.462+0000] {subprocess.py:106} INFO -  - scikit-learn (current: 1.6.1, required: scikit-learn==1.4.1.post1)
[2025-04-29T17:10:35.463+0000] {subprocess.py:106} INFO -  - lightgbm (current: 4.6.0, required: lightgbm==4.3.0)
[2025-04-29T17:10:35.464+0000] {subprocess.py:106} INFO - To fix the mismatches, call `mlflow.pyfunc.get_model_dependencies(model_uri)` to fetch the model's environment and install dependencies using the resulting environment file.
[2025-04-29T17:10:35.598+0000] {subprocess.py:106} INFO - Successfully registered model 'fraud_model'.
[2025-04-29T17:10:35.625+0000] {subprocess.py:106} INFO - 2025/04/29 17:10:35 INFO mlflow.store.model_registry.abstract_store: Waiting up to 300 seconds for model version to finish creation. Model name: fraud_model, version 1
[2025-04-29T17:10:35.626+0000] {subprocess.py:106} INFO - Created version '1' of model 'fraud_model'.
[2025-04-29T17:10:35.627+0000] {subprocess.py:106} INFO - /opt/mlflow/train.py:130: FutureWarning: ``mlflow.tracking.client.MlflowClient.get_latest_versions`` is deprecated since 2.9.0. Model registry stages will be removed in a future major release. To learn more about the deprecation of model registry stages, see our migration guide here: https://mlflow.org/docs/2.10.2/model-registry.html#migrating-from-stages
[2025-04-29T17:10:35.628+0000] {subprocess.py:106} INFO -   latest = client.get_latest_versions("fraud_model", stages=["None"])[0]
[2025-04-29T17:10:35.676+0000] {subprocess.py:106} INFO - /opt/mlflow/train.py:131: FutureWarning: ``mlflow.tracking.client.MlflowClient.transition_model_version_stage`` is deprecated since 2.9.0. Model registry stages will be removed in a future major release. To learn more about the deprecation of model registry stages, see our migration guide here: https://mlflow.org/docs/2.10.2/model-registry.html#migrating-from-stages
[2025-04-29T17:10:35.677+0000] {subprocess.py:106} INFO -   client.transition_model_version_stage(
[2025-04-29T17:10:35.753+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] bagging_freq is set=5, subsample_freq=0 will be ignored. Current value: bagging_freq=5
[2025-04-29T17:10:35.754+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] feature_fraction is set=0.8, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.8
[2025-04-29T17:10:35.759+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] bagging_fraction is set=0.8, subsample=1.0 will be ignored. Current value: bagging_fraction=0.8
[2025-04-29T17:10:35.761+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] bagging_freq is set=5, subsample_freq=0 will be ignored. Current value: bagging_freq=5
[2025-04-29T17:10:35.763+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] feature_fraction is set=0.8, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.8
[2025-04-29T17:10:35.764+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] bagging_fraction is set=0.8, subsample=1.0 will be ignored. Current value: bagging_fraction=0.8
[2025-04-29T17:10:35.766+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] bagging_freq is set=5, subsample_freq=0 will be ignored. Current value: bagging_freq=5
[2025-04-29T17:10:35.768+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] feature_fraction is set=0.8, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.8
[2025-04-29T17:10:35.768+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] bagging_fraction is set=0.8, subsample=1.0 will be ignored. Current value: bagging_fraction=0.8
[2025-04-29T17:10:35.768+0000] {subprocess.py:106} INFO - [50]	valid_0's auc: 0.994214	valid_0's binary_logloss: 0.0525906
[2025-04-29T17:10:35.768+0000] {subprocess.py:106} INFO - [100]	valid_0's auc: 0.99451	valid_0's binary_logloss: 0.0359186
[2025-04-29T17:10:35.768+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] bagging_freq is set=5, subsample_freq=0 will be ignored. Current value: bagging_freq=5
[2025-04-29T17:10:35.768+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] feature_fraction is set=0.8, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.8
[2025-04-29T17:10:35.769+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] bagging_fraction is set=0.8, subsample=1.0 will be ignored. Current value: bagging_fraction=0.8
[2025-04-29T17:10:35.769+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] bagging_freq is set=5, subsample_freq=0 will be ignored. Current value: bagging_freq=5
[2025-04-29T17:10:35.769+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] feature_fraction is set=0.8, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.8
[2025-04-29T17:10:35.769+0000] {subprocess.py:106} INFO - [LightGBM] [Warning] bagging_fraction is set=0.8, subsample=1.0 will be ignored. Current value: bagging_fraction=0.8
[2025-04-29T17:10:35.769+0000] {subprocess.py:106} INFO - ðŸš€ Promoted fraud_model v1 to Production
[2025-04-29T17:10:36.234+0000] {subprocess.py:110} INFO - Command exited with return code 0
[2025-04-29T17:10:36.272+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-04-29T17:10:36.273+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=retrain_on_drift, task_id=train_log_mlflow, run_id=manual__2025-04-29T17:09:37.899896+00:00, execution_date=20250429T170937, start_date=20250429T171014, end_date=20250429T171036
[2025-04-29T17:10:36.282+0000] {logging_mixin.py:190} INFO - Task instance in success state
[2025-04-29T17:10:36.282+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: running
[2025-04-29T17:10:36.282+0000] {logging_mixin.py:190} INFO - Dag name:retrain_on_drift queued_at:2025-04-29 17:09:37.921130+00:00
[2025-04-29T17:10:36.282+0000] {logging_mixin.py:190} INFO - Task hostname:fca622891bf8 operator:BashOperator
[2025-04-29T17:10:36.328+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-04-29T17:10:36.352+0000] {taskinstance.py:3895} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-04-29T17:10:36.353+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
